close all;
clear;

Tiff_01 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_01.tif');
Tiff_02 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_02.tif');
Tiff_03 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_03.tif');
Tiff_04 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_04.tif');
Tiff_05 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_05.tif');
Tiff_06 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_06.tif');
Tiff_07 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_07.tif');
Tiff_08 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_08.tif');
Tiff_09 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_09.tif');
Tiff_10 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_10.tif');

Tiff_11 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_11.tif');
Tiff_12 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_12.tif');
Tiff_13 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_13.tif');
Tiff_14 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_14.tif');
Tiff_15 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_15.tif');
Tiff_16 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_16.tif');
Tiff_17 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_17.tif');
Tiff_18 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_18.tif');
Tiff_19 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_19.tif');
Tiff_20 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_20.tif');

Tiff_21 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_21.tif');
Tiff_22 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_22.tif');
Tiff_23 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_23.tif');
Tiff_24 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_24.tif');
Tiff_25 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_25.tif');
Tiff_26 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_26.tif');
Tiff_27 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_27.tif');
Tiff_28 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_28.tif');
Tiff_29 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_29.tif');
Tiff_30 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_30.tif');

Tiff_31 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_31.tif');
Tiff_32 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_32.tif');
Tiff_33 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_33.tif');
Tiff_34 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_34.tif');
Tiff_35 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_35.tif');
Tiff_36 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_36.tif');
Tiff_37 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_37.tif');
Tiff_38 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_38.tif');
Tiff_39 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_39.tif');
Tiff_40 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_40.tif');

Tiff_41 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_41.tif');
Tiff_42 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_42.tif');
Tiff_43 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_43.tif');
Tiff_44 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_44.tif');
Tiff_45 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_45.tif');
Tiff_46 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_46.tif');
Tiff_47 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_47.tif');
Tiff_48 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_48.tif');
Tiff_49 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_49.tif');
Tiff_50 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_50.tif');

Tiff_51 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_51.tif');
Tiff_52 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_52.tif');
Tiff_53 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_53.tif');
Tiff_54 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_54.tif');
Tiff_55 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_55.tif');
Tiff_56 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_56.tif');
Tiff_57 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_57.tif');
Tiff_58 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_58.tif');
Tiff_59 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_59.tif');
Tiff_60 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_60.tif');

Tiff_61 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_61.tif');
Tiff_62 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_62.tif');
Tiff_63 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\NIR_XYZDRRRD_63.tif');


% Tiff_01 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_01.tif');
% Tiff_02 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_02.tif');
% Tiff_03 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_03.tif');
% Tiff_04 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_04.tif');
% Tiff_05 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_05.tif');
% Tiff_06 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_06.tif');
% Tiff_07 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_07.tif');
% Tiff_08 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_08.tif');
% Tiff_09 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_09.tif');
% Tiff_10 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_10.tif');
% 
% Tiff_11 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_11.tif');
% Tiff_12 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_12.tif');
% Tiff_13 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_13.tif');
% Tiff_14 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_14.tif');
% Tiff_15 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_15.tif');
% Tiff_16 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_16.tif');
% Tiff_17 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_17.tif');
% Tiff_18 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_18.tif');
% Tiff_19 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_19.tif');
% Tiff_20 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_20.tif');
% 
% Tiff_21 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_21.tif');
% Tiff_22 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_22.tif');
% Tiff_23 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_23.tif');
% Tiff_24 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_24.tif');
% Tiff_25 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_25.tif');
% Tiff_26 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_26.tif');
% Tiff_27 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_27.tif');
% Tiff_28 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_28.tif');
% Tiff_29 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_29.tif');
% Tiff_30 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_30.tif');
% 
% Tiff_31 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_31.tif');
% Tiff_32 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_32.tif');
% Tiff_33 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_33.tif');
% Tiff_34 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_34.tif');
% Tiff_35 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_35.tif');
% Tiff_36 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_36.tif');
% Tiff_37 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_37.tif');
% Tiff_38 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_38.tif');
% Tiff_39 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_39.tif');
% Tiff_40 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_40.tif');
% 
% Tiff_41 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_41.tif');
% Tiff_42 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_42.tif');
% Tiff_43 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_43.tif');
% Tiff_44 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_44.tif');
% Tiff_45 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_45.tif');
% Tiff_46 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_46.tif');
% Tiff_47 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_47.tif');
% Tiff_48 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_48.tif');
% Tiff_49 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_49.tif');
% Tiff_50 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_50.tif');
% 
% Tiff_51 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_51.tif');
% Tiff_52 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_52.tif');
% Tiff_53 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_53.tif');
% Tiff_54 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_54.tif');
% Tiff_55 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_55.tif');
% Tiff_56 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_56.tif');
% Tiff_57 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_57.tif');
% Tiff_58 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_58.tif');
% Tiff_59 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_59.tif');
% Tiff_60 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_60.tif');
% 
% Tiff_61 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_61.tif');
% Tiff_62 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_62.tif');
% Tiff_63 = imread('C:\Users\liziy\Developer\Matlab Analysis\Color_RGB_Data\RGB_XYZDRGBD_63.tif');

% clear X;
% clear Y;
% clear Z;
% clear T;
% clear D;
X = zeros(424, 512, 63);
Y = zeros(424, 512, 63);
Z = zeros(424, 512, 63);
D = zeros(424, 512, 63);
T = zeros(424, 512, 63);

X(:, :, 1) = Tiff_01(:, :, 1);
X(:, :, 2) = Tiff_02(:, :, 1);
X(:, :, 3) = Tiff_03(:, :, 1);
X(:, :, 4) = Tiff_04(:, :, 1);
X(:, :, 5) = Tiff_05(:, :, 1);
X(:, :, 6) = Tiff_06(:, :, 1);
X(:, :, 7) = Tiff_07(:, :, 1);
X(:, :, 8) = Tiff_08(:, :, 1);
X(:, :, 9) = Tiff_09(:, :, 1);
X(:, :, 10) = Tiff_10(:, :, 1);

X(:, :, 11) = Tiff_11(:, :, 1);
X(:, :, 12) = Tiff_12(:, :, 1);
X(:, :, 13) = Tiff_13(:, :, 1);
X(:, :, 14) = Tiff_14(:, :, 1);
X(:, :, 15) = Tiff_15(:, :, 1);
X(:, :, 16) = Tiff_16(:, :, 1);
X(:, :, 17) = Tiff_17(:, :, 1);
X(:, :, 18) = Tiff_18(:, :, 1);
X(:, :, 19) = Tiff_19(:, :, 1);
X(:, :, 20) = Tiff_20(:, :, 1);

X(:, :, 21) = Tiff_21(:, :, 1);
X(:, :, 22) = Tiff_22(:, :, 1);
X(:, :, 23) = Tiff_23(:, :, 1);
X(:, :, 24) = Tiff_24(:, :, 1);
X(:, :, 25) = Tiff_25(:, :, 1);
X(:, :, 26) = Tiff_26(:, :, 1);
X(:, :, 27) = Tiff_27(:, :, 1);
X(:, :, 28) = Tiff_28(:, :, 1);
X(:, :, 29) = Tiff_29(:, :, 1);
X(:, :, 30) = Tiff_30(:, :, 1);

X(:, :, 31) = Tiff_31(:, :, 1);
X(:, :, 32) = Tiff_32(:, :, 1);
X(:, :, 33) = Tiff_33(:, :, 1);
X(:, :, 34) = Tiff_34(:, :, 1);
X(:, :, 35) = Tiff_35(:, :, 1);
X(:, :, 36) = Tiff_36(:, :, 1);
X(:, :, 37) = Tiff_37(:, :, 1);
X(:, :, 38) = Tiff_38(:, :, 1);
X(:, :, 39) = Tiff_39(:, :, 1);
X(:, :, 40) = Tiff_40(:, :, 1);

X(:, :, 41) = Tiff_41(:, :, 1);
X(:, :, 42) = Tiff_42(:, :, 1);
X(:, :, 43) = Tiff_43(:, :, 1);
X(:, :, 44) = Tiff_44(:, :, 1);
X(:, :, 45) = Tiff_45(:, :, 1);
X(:, :, 46) = Tiff_46(:, :, 1);
X(:, :, 47) = Tiff_47(:, :, 1);
X(:, :, 48) = Tiff_48(:, :, 1);
X(:, :, 49) = Tiff_49(:, :, 1);
X(:, :, 50) = Tiff_50(:, :, 1);

X(:, :, 51) = Tiff_51(:, :, 1);
X(:, :, 52) = Tiff_52(:, :, 1);
X(:, :, 53) = Tiff_53(:, :, 1);
X(:, :, 54) = Tiff_54(:, :, 1);
X(:, :, 55) = Tiff_55(:, :, 1);
X(:, :, 56) = Tiff_56(:, :, 1);
X(:, :, 57) = Tiff_57(:, :, 1);
X(:, :, 58) = Tiff_58(:, :, 1);
X(:, :, 59) = Tiff_59(:, :, 1);
X(:, :, 60) = Tiff_60(:, :, 1);

X(:, :, 61) = Tiff_61(:, :, 1);
X(:, :, 62) = Tiff_62(:, :, 1);
X(:, :, 63) = Tiff_63(:, :, 1);

for m = 1:26
    X(:, :, m) = X(:, :, m) - 1;
end
X(:, :, 28) = X(:, :, 28) - 1;
X(:, :, 31) = X(:, :, 31) - 1;
X(:, :, 34) = X(:, :, 34) - 1;

Y(:, :, 1) = Tiff_01(:, :, 2);
Y(:, :, 2) = Tiff_02(:, :, 2);
Y(:, :, 3) = Tiff_03(:, :, 2);
Y(:, :, 4) = Tiff_04(:, :, 2);
Y(:, :, 5) = Tiff_05(:, :, 2);
Y(:, :, 6) = Tiff_06(:, :, 2);
Y(:, :, 7) = Tiff_07(:, :, 2);
Y(:, :, 8) = Tiff_08(:, :, 2);
Y(:, :, 9) = Tiff_09(:, :, 2);
Y(:, :, 10) = Tiff_10(:, :, 2);

Y(:, :, 11) = Tiff_11(:, :, 2);
Y(:, :, 12) = Tiff_12(:, :, 2);
Y(:, :, 13) = Tiff_13(:, :, 2);
Y(:, :, 14) = Tiff_14(:, :, 2);
Y(:, :, 15) = Tiff_15(:, :, 2);
Y(:, :, 16) = Tiff_16(:, :, 2);
Y(:, :, 17) = Tiff_17(:, :, 2);
Y(:, :, 18) = Tiff_18(:, :, 2);
Y(:, :, 19) = Tiff_19(:, :, 2);
Y(:, :, 20) = Tiff_20(:, :, 2);

Y(:, :, 21) = Tiff_21(:, :, 2);
Y(:, :, 22) = Tiff_22(:, :, 2);
Y(:, :, 23) = Tiff_23(:, :, 2);
Y(:, :, 24) = Tiff_24(:, :, 2);
Y(:, :, 25) = Tiff_25(:, :, 2);
Y(:, :, 26) = Tiff_26(:, :, 2);
Y(:, :, 27) = Tiff_27(:, :, 2);
Y(:, :, 28) = Tiff_28(:, :, 2);
Y(:, :, 29) = Tiff_29(:, :, 2);
Y(:, :, 30) = Tiff_30(:, :, 2);

Y(:, :, 31) = Tiff_31(:, :, 2);
Y(:, :, 32) = Tiff_32(:, :, 2);
Y(:, :, 33) = Tiff_33(:, :, 2);
Y(:, :, 34) = Tiff_34(:, :, 2);
Y(:, :, 35) = Tiff_35(:, :, 2);
Y(:, :, 36) = Tiff_36(:, :, 2);
Y(:, :, 37) = Tiff_37(:, :, 2);
Y(:, :, 38) = Tiff_38(:, :, 2);
Y(:, :, 39) = Tiff_39(:, :, 2);
Y(:, :, 40) = Tiff_40(:, :, 2);

Y(:, :, 41) = Tiff_41(:, :, 2);
Y(:, :, 42) = Tiff_42(:, :, 2);
Y(:, :, 43) = Tiff_43(:, :, 2);
Y(:, :, 44) = Tiff_44(:, :, 2);
Y(:, :, 45) = Tiff_45(:, :, 2);
Y(:, :, 46) = Tiff_46(:, :, 2);
Y(:, :, 47) = Tiff_47(:, :, 2);
Y(:, :, 48) = Tiff_48(:, :, 2);
Y(:, :, 49) = Tiff_49(:, :, 2);
Y(:, :, 50) = Tiff_50(:, :, 2);

Y(:, :, 51) = Tiff_51(:, :, 2);
Y(:, :, 52) = Tiff_52(:, :, 2);
Y(:, :, 53) = Tiff_53(:, :, 2);
Y(:, :, 54) = Tiff_54(:, :, 2);
Y(:, :, 55) = Tiff_55(:, :, 2);
Y(:, :, 56) = Tiff_56(:, :, 2);
Y(:, :, 57) = Tiff_57(:, :, 2);
Y(:, :, 58) = Tiff_58(:, :, 2);
Y(:, :, 59) = Tiff_59(:, :, 2);
Y(:, :, 60) = Tiff_60(:, :, 2);

Y(:, :, 61) = Tiff_61(:, :, 2);
Y(:, :, 62) = Tiff_62(:, :, 2);
Y(:, :, 63) = Tiff_63(:, :, 2);

Z(:, :, 1) = Tiff_01(:, :, 3);
Z(:, :, 2) = Tiff_02(:, :, 3);
Z(:, :, 3) = Tiff_03(:, :, 3);
Z(:, :, 4) = Tiff_04(:, :, 3);
Z(:, :, 5) = Tiff_05(:, :, 3);
Z(:, :, 6) = Tiff_06(:, :, 3);
Z(:, :, 7) = Tiff_07(:, :, 3);
Z(:, :, 8) = Tiff_08(:, :, 3);
Z(:, :, 9) = Tiff_09(:, :, 3);
Z(:, :, 10) = Tiff_10(:, :, 3);

Z(:, :, 11) = Tiff_11(:, :, 3);
Z(:, :, 12) = Tiff_12(:, :, 3);
Z(:, :, 13) = Tiff_13(:, :, 3);
Z(:, :, 14) = Tiff_14(:, :, 3);
Z(:, :, 15) = Tiff_15(:, :, 3);
Z(:, :, 16) = Tiff_16(:, :, 3);
Z(:, :, 17) = Tiff_17(:, :, 3);
Z(:, :, 18) = Tiff_18(:, :, 3);
Z(:, :, 19) = Tiff_19(:, :, 3);
Z(:, :, 20) = Tiff_20(:, :, 3);

Z(:, :, 21) = Tiff_21(:, :, 3);
Z(:, :, 22) = Tiff_22(:, :, 3);
Z(:, :, 23) = Tiff_23(:, :, 3);
Z(:, :, 24) = Tiff_24(:, :, 3);
Z(:, :, 25) = Tiff_25(:, :, 3);
Z(:, :, 26) = Tiff_26(:, :, 3);
Z(:, :, 27) = Tiff_27(:, :, 3);
Z(:, :, 28) = Tiff_28(:, :, 3);
Z(:, :, 29) = Tiff_29(:, :, 3);
Z(:, :, 30) = Tiff_30(:, :, 3);

Z(:, :, 31) = Tiff_31(:, :, 3);
Z(:, :, 32) = Tiff_32(:, :, 3);
Z(:, :, 33) = Tiff_33(:, :, 3);
Z(:, :, 34) = Tiff_34(:, :, 3);
Z(:, :, 35) = Tiff_35(:, :, 3);
Z(:, :, 36) = Tiff_36(:, :, 3);
Z(:, :, 37) = Tiff_37(:, :, 3);
Z(:, :, 38) = Tiff_38(:, :, 3);
Z(:, :, 39) = Tiff_39(:, :, 3);
Z(:, :, 40) = Tiff_40(:, :, 3);

Z(:, :, 41) = Tiff_41(:, :, 3);
Z(:, :, 42) = Tiff_42(:, :, 3);
Z(:, :, 43) = Tiff_43(:, :, 3);
Z(:, :, 44) = Tiff_44(:, :, 3);
Z(:, :, 45) = Tiff_45(:, :, 3);
Z(:, :, 46) = Tiff_46(:, :, 3);
Z(:, :, 47) = Tiff_47(:, :, 3);
Z(:, :, 48) = Tiff_48(:, :, 3);
Z(:, :, 49) = Tiff_49(:, :, 3);
Z(:, :, 50) = Tiff_50(:, :, 3);

Z(:, :, 51) = Tiff_51(:, :, 3);
Z(:, :, 52) = Tiff_52(:, :, 3);
Z(:, :, 53) = Tiff_53(:, :, 3);
Z(:, :, 54) = Tiff_54(:, :, 3);
Z(:, :, 55) = Tiff_55(:, :, 3);
Z(:, :, 56) = Tiff_56(:, :, 3);
Z(:, :, 57) = Tiff_57(:, :, 3);
Z(:, :, 58) = Tiff_58(:, :, 3);
Z(:, :, 59) = Tiff_59(:, :, 3);
Z(:, :, 60) = Tiff_60(:, :, 3);

Z(:, :, 61) = Tiff_61(:, :, 3);
Z(:, :, 62) = Tiff_62(:, :, 3);
Z(:, :, 63) = Tiff_63(:, :, 3);

% Z = -Z;

D(:, :, 1) = Tiff_01(:, :, 4);
D(:, :, 2) = Tiff_02(:, :, 4);
D(:, :, 3) = Tiff_03(:, :, 4);
D(:, :, 4) = Tiff_04(:, :, 4);
D(:, :, 5) = Tiff_05(:, :, 4);
D(:, :, 6) = Tiff_06(:, :, 4);
D(:, :, 7) = Tiff_07(:, :, 4);
D(:, :, 8) = Tiff_08(:, :, 4);
D(:, :, 9) = Tiff_09(:, :, 4);
D(:, :, 10) = Tiff_10(:, :, 4);

D(:, :, 11) = Tiff_11(:, :, 4);
D(:, :, 12) = Tiff_12(:, :, 4);
D(:, :, 13) = Tiff_13(:, :, 4);
D(:, :, 14) = Tiff_14(:, :, 4);
D(:, :, 15) = Tiff_15(:, :, 4);
D(:, :, 16) = Tiff_16(:, :, 4);
D(:, :, 17) = Tiff_17(:, :, 4);
D(:, :, 18) = Tiff_18(:, :, 4);
D(:, :, 19) = Tiff_19(:, :, 4);
D(:, :, 20) = Tiff_20(:, :, 4);

D(:, :, 21) = Tiff_21(:, :, 4);
D(:, :, 22) = Tiff_22(:, :, 4);
D(:, :, 23) = Tiff_23(:, :, 4);
D(:, :, 24) = Tiff_24(:, :, 4);
D(:, :, 25) = Tiff_25(:, :, 4);
D(:, :, 26) = Tiff_26(:, :, 4);
D(:, :, 27) = Tiff_27(:, :, 4);
D(:, :, 28) = Tiff_28(:, :, 4);
D(:, :, 29) = Tiff_29(:, :, 4);
D(:, :, 30) = Tiff_30(:, :, 4);

D(:, :, 31) = Tiff_31(:, :, 4);
D(:, :, 32) = Tiff_32(:, :, 4);
D(:, :, 33) = Tiff_33(:, :, 4);
D(:, :, 34) = Tiff_34(:, :, 4);
D(:, :, 35) = Tiff_35(:, :, 4);
D(:, :, 36) = Tiff_36(:, :, 4);
D(:, :, 37) = Tiff_37(:, :, 4);
D(:, :, 38) = Tiff_38(:, :, 4);
D(:, :, 39) = Tiff_39(:, :, 4);
D(:, :, 40) = Tiff_40(:, :, 4);

D(:, :, 41) = Tiff_41(:, :, 4);
D(:, :, 42) = Tiff_42(:, :, 4);
D(:, :, 43) = Tiff_43(:, :, 4);
D(:, :, 44) = Tiff_44(:, :, 4);
D(:, :, 45) = Tiff_45(:, :, 4);
D(:, :, 46) = Tiff_46(:, :, 4);
D(:, :, 47) = Tiff_47(:, :, 4);
D(:, :, 48) = Tiff_48(:, :, 4);
D(:, :, 49) = Tiff_49(:, :, 4);
D(:, :, 50) = Tiff_50(:, :, 4);

D(:, :, 51) = Tiff_51(:, :, 4);
D(:, :, 52) = Tiff_52(:, :, 4);
D(:, :, 53) = Tiff_53(:, :, 4);
D(:, :, 54) = Tiff_54(:, :, 4);
D(:, :, 55) = Tiff_55(:, :, 4);
D(:, :, 56) = Tiff_56(:, :, 4);
D(:, :, 57) = Tiff_57(:, :, 4);
D(:, :, 58) = Tiff_58(:, :, 4);
D(:, :, 59) = Tiff_59(:, :, 4);
D(:, :, 60) = Tiff_60(:, :, 4);

D(:, :, 61) = Tiff_61(:, :, 4);
D(:, :, 62) = Tiff_62(:, :, 4);
D(:, :, 63) = Tiff_63(:, :, 4);

for row = 1:424
    for col = 1:512
        for frame = 1:63
            if (-5000*D(row, col, frame) <= 20 ...
                || -5000*D(row, col, frame) >=200)
                D(row, col, frame) = NaN;
            end
        end
    end
end

T(:, :, 1) = Tiff_01(:, :, 5);
T(:, :, 2) = Tiff_02(:, :, 5);
T(:, :, 3) = Tiff_03(:, :, 5);
T(:, :, 4) = Tiff_04(:, :, 5);
T(:, :, 5) = Tiff_05(:, :, 5);
T(:, :, 6) = Tiff_06(:, :, 5);
T(:, :, 7) = Tiff_07(:, :, 5);
T(:, :, 8) = Tiff_08(:, :, 5);
T(:, :, 9) = Tiff_09(:, :, 5);
T(:, :, 10) = Tiff_10(:, :, 5);

T(:, :, 11) = Tiff_11(:, :, 5);
T(:, :, 12) = Tiff_12(:, :, 5);
T(:, :, 13) = Tiff_13(:, :, 5);
T(:, :, 14) = Tiff_14(:, :, 5);
T(:, :, 15) = Tiff_15(:, :, 5);
T(:, :, 16) = Tiff_16(:, :, 5);
T(:, :, 17) = Tiff_17(:, :, 5);
T(:, :, 18) = Tiff_18(:, :, 5);
T(:, :, 19) = Tiff_19(:, :, 5);
T(:, :, 20) = Tiff_20(:, :, 5);

T(:, :, 21) = Tiff_21(:, :, 5);
T(:, :, 22) = Tiff_22(:, :, 5);
T(:, :, 23) = Tiff_23(:, :, 5);
T(:, :, 24) = Tiff_24(:, :, 5);
T(:, :, 25) = Tiff_25(:, :, 5);
T(:, :, 26) = Tiff_26(:, :, 5);
T(:, :, 27) = Tiff_27(:, :, 5);
T(:, :, 28) = Tiff_28(:, :, 5);
T(:, :, 29) = Tiff_29(:, :, 5);
T(:, :, 30) = Tiff_30(:, :, 5);

T(:, :, 31) = Tiff_31(:, :, 5);
T(:, :, 32) = Tiff_32(:, :, 5);
T(:, :, 33) = Tiff_33(:, :, 5);
T(:, :, 34) = Tiff_34(:, :, 5);
T(:, :, 35) = Tiff_35(:, :, 5);
T(:, :, 36) = Tiff_36(:, :, 5);
T(:, :, 37) = Tiff_37(:, :, 5);
T(:, :, 38) = Tiff_38(:, :, 5);
T(:, :, 39) = Tiff_39(:, :, 5);
T(:, :, 40) = Tiff_40(:, :, 5);

T(:, :, 41) = Tiff_41(:, :, 5);
T(:, :, 42) = Tiff_42(:, :, 5);
T(:, :, 43) = Tiff_43(:, :, 5);
T(:, :, 44) = Tiff_44(:, :, 5);
T(:, :, 45) = Tiff_45(:, :, 5);
T(:, :, 46) = Tiff_46(:, :, 5);
T(:, :, 47) = Tiff_47(:, :, 5);
T(:, :, 48) = Tiff_48(:, :, 5);
T(:, :, 49) = Tiff_49(:, :, 5);
T(:, :, 50) = Tiff_50(:, :, 5);

T(:, :, 51) = Tiff_51(:, :, 5);
T(:, :, 52) = Tiff_52(:, :, 5);
T(:, :, 53) = Tiff_53(:, :, 5);
T(:, :, 54) = Tiff_54(:, :, 5);
T(:, :, 55) = Tiff_55(:, :, 5);
T(:, :, 56) = Tiff_56(:, :, 5);
T(:, :, 57) = Tiff_57(:, :, 5);
T(:, :, 58) = Tiff_58(:, :, 5);
T(:, :, 59) = Tiff_59(:, :, 5);
T(:, :, 60) = Tiff_60(:, :, 5);

T(:, :, 61) = Tiff_61(:, :, 5);
T(:, :, 62) = Tiff_62(:, :, 5);
T(:, :, 63) = Tiff_63(:, :, 5);




figure(4);
for m = 1:63
    warp(65535*D(:,:,m)/228,X(:,:,m),Y(:,:,m),T(:,:,m));
    hold on;
%                                 VecX = zeros(512,1);
%                                 VecY = zeros(512,1);
%                                 VecZ = zeros(512,1);
%                                 
%                                 for col = 1:512
%                                     VecX(col, 1) = X(1,col,m);
%                                     VecY(col, 1) = Y(1,col, m);
%                                     VecZ(col, 1) = Z(5,5,m);
%                                 end
%                                 plot3(VecZ, VecX, VecY, 'k-');
% 
%                                 for col = 1:512
%                                     VecX(col, 1) = X(424,col,m);
%                                     VecY(col, 1) = Y(424, col, m);
%                                     VecZ(col, 1) = Z(5,5,m);
%                                 end
%                                 plot3(VecZ, VecX, VecY, 'k-');
% 
%                                 
%                                 VecX = zeros(424,1);
%                                 VecY = zeros(424,1);
%                                 VecZ = zeros(424,1);
%                                 for row = 1:424
%                                     VecX(row, 1) = X(row,1,m);
%                                     VecY(row, 1) = Y(row, 1, m);
%                                     VecZ(row, 1) = Z(5,5,m);
%                                 end
%                                 plot3(VecZ, VecX, VecY, 'k-');
% 
%                                 for row = 1:424
%                                     VecX(row, 1) = X(row,512,m);
%                                     VecY(row, 1) = Y(row, 512, m);
%                                     VecZ(row, 1) = Z(5,5,m);
%                                 end
%                                 plot3(VecZ, VecX, VecY, 'k-');
% 
%                                 plot3(0,0,0,'bO');
%                                 plot3(0,0,0,'b*');
%                                 plot3(0,0,0,'bo');
%                                 xx = -11.9:0.1:0;
%                                 yy = 0*xx;
%                                 zz = 0*xx;
%                                 plot3(xx, yy, zz, 'b');


end
axis equal;
xlabel('D');
ylabel('X^w');
zlabel('Y^w');

% figure(5);
% for m = 1:63
%     warp(Z(:,:,m), X(:,:,m),Y(:,:,m),T(:,:,m));
%     hold on;
% end
% % axis equal;
% xlabel('X^w');
% ylabel('Y^w');
% zlabel('Z^w');

% X_corner = zeros(63, 1);
% for n = 1:63
%     X_corner(n, 1) = X(1, 1, n);
% end
% 
% Z_corner = zeros(63, 1);
% D_corner = zeros(63, 1);
% for n = 1:63
%     D_frame = 0;
%     Z_frame = 0;
%     totalPerFrame = 0;
%     for row = 1:424
%         for column = 1:512
%             D_frame = D_frame + D(row, column, n);
%             Z_frame = Z_frame + Z(row, column, n);
%             totalPerFrame = totalPerFrame + 1;
%         end
%     end
%     
%     D_corner(n, 1) = D_frame / totalPerFrame;
%     Z_corner(n, 1) = Z_frame / totalPerFrame;
% end


